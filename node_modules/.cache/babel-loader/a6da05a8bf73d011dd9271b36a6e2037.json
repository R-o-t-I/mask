{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nvar _excluded = [\"platform\", \"children\"],\n    _excluded2 = [\"before\", \"className\", \"defaultValue\", \"placeholder\", \"after\", \"getRef\", \"platform\", \"icon\", \"onIconClick\", \"style\"];\nimport { createScopedElement } from \"../../lib/jsxRuntime\";\nimport * as React from \"react\";\nimport { classNames } from \"../../lib/classNames\";\nimport { withPlatform } from \"../../hoc/withPlatform\";\nimport { getClassName } from \"../../helpers/getClassName\";\nimport { Icon16SearchOutline, Icon16Clear, Icon24Cancel } from \"@vkontakte/icons\";\nimport { IOS, VKCOM, ANDROID } from \"../../lib/platform\";\nimport { Touch } from \"../Touch/Touch\";\nimport { noop } from \"../../lib/utils\";\nimport Text from \"../Typography/Text/Text\";\nimport Title from \"../Typography/Title/Title\";\nimport Headline from \"../Typography/Headline/Headline\";\nimport Separator from \"../Separator/Separator\";\nimport { useExternRef } from \"../../hooks/useExternRef\";\nimport { useEnsuredControl } from \"../../hooks/useEnsuredControl\";\n\nvar SearchPlaceholderTypography = function SearchPlaceholderTypography(_ref) {\n  var platform = _ref.platform,\n      children = _ref.children,\n      restProps = _objectWithoutProperties(_ref, _excluded);\n\n  switch (platform) {\n    case IOS:\n      return createScopedElement(Title, _extends({}, restProps, {\n        level: \"3\",\n        weight: \"3\"\n      }), children);\n\n    case VKCOM:\n      return createScopedElement(Text, _extends({}, restProps, {\n        weight: \"regular\"\n      }), children);\n\n    case ANDROID:\n    default:\n      return createScopedElement(Headline, _extends({}, restProps, {\n        weight: \"regular\"\n      }), children);\n  }\n};\n\nvar Search = function Search(_ref2) {\n  var before = _ref2.before,\n      className = _ref2.className,\n      defaultValue = _ref2.defaultValue,\n      placeholder = _ref2.placeholder,\n      after = _ref2.after,\n      getRef = _ref2.getRef,\n      platform = _ref2.platform,\n      icon = _ref2.icon,\n      _ref2$onIconClick = _ref2.onIconClick,\n      onIconClick = _ref2$onIconClick === void 0 ? noop : _ref2$onIconClick,\n      style = _ref2.style,\n      inputProps = _objectWithoutProperties(_ref2, _excluded2);\n\n  var inputRef = useExternRef(getRef);\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      isFocused = _React$useState2[0],\n      setFocused = _React$useState2[1];\n\n  var _useEnsuredControl = useEnsuredControl(inputProps, {\n    defaultValue: defaultValue\n  }),\n      _useEnsuredControl2 = _slicedToArray(_useEnsuredControl, 2),\n      value = _useEnsuredControl2[0],\n      onChange = _useEnsuredControl2[1];\n\n  var onFocus = function onFocus(e) {\n    setFocused(true);\n    inputProps.onFocus && inputProps.onFocus(e);\n  };\n\n  var onBlur = function onBlur(e) {\n    setFocused(false);\n    inputProps.onBlur && inputProps.onBlur(e);\n  };\n\n  var onCancel = React.useCallback(function () {\n    var _Object$getOwnPropert, _inputRef$current; // eslint-disable-next-line @typescript-eslint/unbound-method\n\n\n    var nativeInputValueSetter = (_Object$getOwnPropert = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, \"value\")) === null || _Object$getOwnPropert === void 0 ? void 0 : _Object$getOwnPropert.set;\n    nativeInputValueSetter === null || nativeInputValueSetter === void 0 ? void 0 : nativeInputValueSetter.call(inputRef.current, \"\");\n    var ev2 = new Event(\"input\", {\n      bubbles: true\n    });\n    (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.dispatchEvent(ev2);\n  }, [inputRef]);\n  var onIconClickStart = React.useCallback(function (e) {\n    return onIconClick(e.originalEvent);\n  }, [onIconClick]);\n  var onIconCancelClickStart = React.useCallback(function (e) {\n    var _inputRef$current2;\n\n    e.originalEvent.preventDefault();\n    (_inputRef$current2 = inputRef.current) === null || _inputRef$current2 === void 0 ? void 0 : _inputRef$current2.focus();\n    onCancel();\n  }, [inputRef, onCancel]);\n  return createScopedElement(\"div\", {\n    vkuiClass: classNames(getClassName(\"Search\", platform), {\n      \"Search--focused\": isFocused,\n      \"Search--has-value\": !!value,\n      \"Search--has-after\": !!after,\n      \"Search--has-icon\": !!icon\n    }),\n    className: className,\n    style: style\n  }, createScopedElement(\"div\", {\n    vkuiClass: \"Search__in\"\n  }, createScopedElement(\"div\", {\n    vkuiClass: \"Search__width\"\n  }), createScopedElement(\"label\", {\n    vkuiClass: \"Search__control\"\n  }, createScopedElement(\"input\", _extends({\n    type: \"search\"\n  }, inputProps, {\n    ref: inputRef,\n    vkuiClass: \"Search__input\",\n    onFocus: onFocus,\n    onBlur: onBlur,\n    onChange: onChange,\n    value: value\n  })), platform === IOS && after && createScopedElement(\"div\", {\n    vkuiClass: \"Search__after-width\"\n  }, after), createScopedElement(\"div\", {\n    vkuiClass: \"Search__placeholder\"\n  }, createScopedElement(\"div\", {\n    vkuiClass: \"Search__placeholder-in\"\n  }, before, createScopedElement(SearchPlaceholderTypography, {\n    vkuiClass: \"Search__placeholder-text\",\n    platform: platform\n  }, placeholder)), isFocused && platform === IOS && after && createScopedElement(\"div\", {\n    vkuiClass: \"Search__after-width\"\n  }, after))), createScopedElement(\"div\", {\n    vkuiClass: \"Search__after\",\n    onClick: onCancel\n  }, createScopedElement(\"div\", {\n    vkuiClass: \"Search__icons\"\n  }, icon && createScopedElement(Touch, {\n    onStart: onIconClickStart,\n    vkuiClass: \"Search__icon\"\n  }, icon), !!value && createScopedElement(Touch, {\n    onStart: onIconCancelClickStart,\n    vkuiClass: \"Search__icon\"\n  }, platform === IOS ? createScopedElement(Icon16Clear, null) : createScopedElement(Icon24Cancel, null))), platform === IOS && after && createScopedElement(\"div\", {\n    vkuiClass: \"Search__after-in\"\n  }, after))), platform === VKCOM && createScopedElement(Separator, {\n    vkuiClass: \"Search__separator\",\n    wide: true\n  }));\n};\n\nSearch.defaultProps = {\n  autoComplete: \"off\",\n  defaultValue: \"\",\n  placeholder: \"Поиск\",\n  after: \"Отмена\",\n  before: createScopedElement(Icon16SearchOutline, null)\n}; // eslint-disable-next-line import/no-default-export\n\nexport default withPlatform(Search);","map":null,"metadata":{},"sourceType":"module"}